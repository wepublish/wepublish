fragment FullPaymentProviderCustomer on PaymentProviderCustomer {
  paymentProviderID
  customerID
}

fragment FullBaseUser on BaseUser {
  id
  name
  firstName
  flair

  image {
    ...FullImage
  }

  properties {
    ...FullProperty
  }
}

fragment FullUser on User {
  ...FullBaseUser
}

fragment FullSensitiveDataUser on SensitiveDataUser {
  ...FullBaseUser
  permissions
  birthday
  email

  address {
    ...FullAddress
  }

  paymentProviderCustomers {
    ...FullPaymentProviderCustomer
  }
}

fragment FullAddress on UserAddress {
  company
  streetAddress
  streetAddressNumber
  streetAddress2
  streetAddress2Number
  zipCode
  city
  country
}

fragment FullSessionWithTokenWithoutUser on SessionWithTokenWithoutUser {
  token
  expiresAt
  createdAt
}

fragment FullSessionWithToken on SessionWithToken {
  token
  expiresAt
  createdAt
}

query Me {
  me {
    ...FullSensitiveDataUser
  }
}

mutation LoginWithCredentials($email: String!, $password: String!) {
  createSession(email: $email, password: $password) {
    ...FullSessionWithToken
  }
}

mutation LoginWithEmail($email: String!) {
  sendWebsiteLogin(email: $email)
}

mutation LoginWithJWT($jwt: String!) {
  createSessionWithJWT(jwt: $jwt) {
    ...FullSessionWithToken
  }
}

mutation Register(
  $name: String!
  $flair: String
  $firstName: String
  $birthday: DateTime
  $address: UserAddressInput
  $email: String!
  $password: String
  $challengeAnswer: ChallengeInput!
) {
  registerMember(
    name: $name
    flair: $flair
    firstName: $firstName
    birthday: $birthday
    address: $address
    email: $email
    password: $password
    challengeAnswer: $challengeAnswer
  ) {
    user {
      ...FullSensitiveDataUser
    }

    session {
      ...FullSessionWithTokenWithoutUser
    }
  }
}

mutation UpdateUser(
  $firstName: String
  $flair: String
  $name: String
  $email: String
  $password: String
  $address: UserAddressInput
  $birthday: DateTime
) {
  updateCurrentUser(
    name: $name
    firstName: $firstName
    flair: $flair
    email: $email
    password: $password
    address: $address
    birthday: $birthday
  ) {
    ...FullSensitiveDataUser
  }
}

mutation UpdatePassword($password: String!, $passwordRepeated: String!) {
  updatePassword(password: $password, passwordRepeated: $passwordRepeated) {
    ...FullSensitiveDataUser
  }
}
